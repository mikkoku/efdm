<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Example scenarios</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Example scenarios</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(gridExtra)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(efdm)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">theme_set</span>(<span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">-90</span>)))</a></code></pre></div>
<div id="estimate-transition-probabilities-and-set-up-actitivies" class="section level2">
<h2>Estimate transition probabilities and set up actitivies</h2>
<p>Statespace is the collection of all possible states of classifying variables and can be obtained from actprob by removing the activity probabilities (in our case, thin = thinning, ff = final felling, noman = no management). It is used for constructing transition probabilities.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">statespace &lt;-<span class="st"> </span>example<span class="op">$</span>actprob <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(thin, ff, noman))</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">head</span>(statespace)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt;   region    soil    sp vol age</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt; 1  South Mineral other   1   1</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; 2  South Mineral other   1   2</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; 3  South Mineral other   1   3</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; 4  South Mineral other   1   4</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt; 5  South Mineral other   1   5</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt; 6  South Mineral other   1   6</span></a></code></pre></div>
<p>Use pair data to estimate transition probabilities for actitivies no management and thinning.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">head</span>(example<span class="op">$</span>noman_pairs)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt;   region    soil     sp vol0 vol1 age0 age1</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt; 1  South Mineral spruce   10    7   13   14</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt; 2  South Mineral spruce    8    8   20   21</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; 3  South Mineral  other    9   10    5    6</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; 4  South Mineral  other    1    1    1    2</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; 5  South Mineral  other    7    8    2    3</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; 6  South Mineral  other    7   10    5    6</span></a></code></pre></div>
<p>Statespace and prior are used to fill the missing combinations from pairdata. Here we simply assume that age grows by one age class if no data is seen. Transitions are estimated separately for each region and species. The esimation procedure uses data from different soil types with less weight than the correct soil type.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">act &lt;-<span class="st"> </span><span class="kw">define_activity</span>(<span class="st">&quot;noman&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>))</a>
<a class="sourceLine" id="cb4-2" title="2">act &lt;-<span class="st"> </span><span class="kw">build_statespace</span>(act, statespace,</a>
<a class="sourceLine" id="cb4-3" title="3">                        <span class="dt">factors=</span><span class="kw">c</span>(<span class="st">&quot;soil&quot;</span>), <span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;region&quot;</span>,<span class="st">&quot;sp&quot;</span>))</a>
<a class="sourceLine" id="cb4-4" title="4">noman &lt;-<span class="st"> </span><span class="kw">estimatetransprobs</span>(act, example<span class="op">$</span>noman_pairs, <span class="kw">prior_grow</span>(<span class="st">&quot;age&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">act &lt;-<span class="st"> </span><span class="kw">define_activity</span>(<span class="st">&quot;thin&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>))</a>
<a class="sourceLine" id="cb5-2" title="2">act &lt;-<span class="st"> </span><span class="kw">build_statespace</span>(act, statespace,</a>
<a class="sourceLine" id="cb5-3" title="3">                        <span class="dt">factors=</span><span class="kw">c</span>(<span class="st">&quot;soil&quot;</span>), <span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;region&quot;</span>,<span class="st">&quot;sp&quot;</span>))</a>
<a class="sourceLine" id="cb5-4" title="4">thin &lt;-<span class="st"> </span><span class="kw">estimatetransprobs</span>(act, example<span class="op">$</span>thin_pairs, <span class="kw">prior_grow</span>(<span class="st">&quot;age&quot;</span>))</a></code></pre></div>
<p>Final felling sets age and volume class to the smallest class. No pairdata is needed/utilized.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">ff &lt;-<span class="st"> </span><span class="kw">define_activity</span>(<span class="st">&quot;ff&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>))</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">transprobs</span>(ff) &lt;-<span class="st"> </span><span class="kw">unique</span>(statespace <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="dt">vol0=</span>vol, <span class="dt">age0=</span>age)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">vol1=</span><span class="dv">1</span>, <span class="dt">age1=</span><span class="dv">1</span>, <span class="dt">prob=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">head</span>(<span class="kw">transprobs</span>(ff))</a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt;   vol0 age0 vol1 age1 prob</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt; 1    1    1    1    1    1</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; 2    1    2    1    1    1</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt; 3    1    3    1    1    1</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt; 4    1    4    1    1    1</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; 5    1    5    1    1    1</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; 6    1    6    1    1    1</span></a></code></pre></div>
</div>
<div id="example-1" class="section level2">
<h2>Example 1</h2>
<p>The activities are collected to a list. The initial state and activity probabilities and the number of time steps are the remaining parameters of the <code>runEFDM</code> function</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">activities &lt;-<span class="st"> </span><span class="kw">list</span>(noman, thin, ff)</a>
<a class="sourceLine" id="cb7-2" title="2">state0 &lt;-<span class="st"> </span>example<span class="op">$</span>initial_state</a>
<a class="sourceLine" id="cb7-3" title="3">actprob &lt;-<span class="st"> </span>example<span class="op">$</span>actprob</a>
<a class="sourceLine" id="cb7-4" title="4"><span class="kw">head</span>(actprob)</a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt;   region    soil    sp vol age noman  thin    ff</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; 1  South Mineral other   1   1 0.976 0.023 0.001</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; 2  South Mineral other   1   2 0.981 0.019 0.000</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; 3  South Mineral other   1   3 0.994 0.006 0.000</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt; 4  South Mineral other   1   4 0.991 0.008 0.001</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt; 5  South Mineral other   1   5 0.764 0.024 0.212</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt; 6  South Mineral other   1   6 0.974 0.025 0.001</span></a></code></pre></div>
<p>EFDM is run for 20 time steps. The length of timestep is determined by the inventory data used to be 5 years.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">states1 &lt;-<span class="st"> </span><span class="kw">runEFDM</span>(state0, actprob, activities, <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">head</span>(states1)</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt;      soil region    sp vol age        area activity time</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt; 1 Mineral Middle other   1   1 101627.6564    noman    0</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt; 2 Mineral Middle other   1   2  73660.4310    noman    0</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; 3 Mineral Middle other   1   3  26299.4701    noman    0</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt; 4 Mineral Middle other   1   4   5982.8223    noman    0</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt; 5 Mineral Middle other   1   5    379.4954    noman    0</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt; 6 Mineral Middle other   1   6   1104.1126    noman    0</span></a></code></pre></div>
<p>runEFDM produces a data.frame of areas allocated to each activity at each timestep.</p>
<p>To obtain total growing stock volume, volume coeffiecients are used. The volume coefficients and drain were estimated based on the species composition and changes in timber assortments linked to management activities observed in the forest inventory data.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">head</span>(example<span class="op">$</span>vol_coef)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">#&gt;   vol    sp species     volume</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#&gt; 1   1 other     all   0.506323</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt; 2  10 other     all 176.677720</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">#&gt; 3  11 other     all 210.438071</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">#&gt; 4  12 other     all 245.009871</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">#&gt; 5  13 other     all 279.955533</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt; 6  14 other     all 314.900072</span></a></code></pre></div>
<p>Drain and income….</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">head</span>(example<span class="op">$</span>drain_coef)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">#&gt;   vol     sp    drain assort activity</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt; 1   1  other 0.000000    saw       ff</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#&gt; 2   1 spruce 0.000000    saw       ff</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#&gt; 3   2  other 0.000000    saw       ff</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt; 4   2 spruce 0.000000    saw       ff</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt; 5   3  other 0.000000    saw       ff</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt; 6   3 spruce 1.012518    saw       ff</span></a></code></pre></div>
<p>Income is loosely linked to the actual timber assortment prices in unit eur/m3.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">head</span>(example<span class="op">$</span>income_coef)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co">#&gt;   assort activity euro</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co">#&gt; 1    saw       ff   56</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">#&gt; 2    saw     thin   44</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">#&gt; 3   pulp       ff   20</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">#&gt; 4   pulp     thin   15</span></a></code></pre></div>
<p>Simulation timesteps are mutated to mid-years of simulation steps:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">states1 &lt;-<span class="st"> </span>states1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">time =</span> <span class="kw">factor</span>(<span class="dv">2016</span> <span class="op">+</span><span class="st"> </span>time<span class="op">*</span><span class="dv">5</span>))</a></code></pre></div>
<p>Growing stock</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">tilstate&lt;-<span class="kw">merge</span>(states1, example<span class="op">$</span>vol_coef) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span> (<span class="dt">volume=</span>area<span class="op">*</span>volume)</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">ggplot</span>(<span class="kw">subset</span>(tilstate,species<span class="op">!=</span><span class="st">&#39;all&#39;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">end =</span> <span class="fl">0.9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x=</span>time, <span class="dt">weight=</span>volume<span class="op">/</span><span class="dv">1000000000</span>,<span class="dt">fill=</span>species)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="ot">NULL</span>,<span class="dt">title=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Growing stock, bil.&quot;</span>,m<span class="op">^</span><span class="dv">3</span>)), <span class="dt">x=</span><span class="st">&quot;Year&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Age distribution</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">states1<span class="op">$</span>ageclass &lt;-<span class="st"> </span><span class="kw">cut</span>(states1<span class="op">$</span>age, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">35</span>), <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb14-2" title="2">                        <span class="co">#labels=c(&quot;0-50&quot;,&quot;51-100&quot;,&quot;101-150&quot;,&quot;150+&quot;))</span></a>
<a class="sourceLine" id="cb14-3" title="3">                        <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;-50&quot;</span>,<span class="st">&quot;-100&quot;</span>,<span class="st">&quot;-150&quot;</span>,<span class="st">&quot;150+&quot;</span>))</a>
<a class="sourceLine" id="cb14-4" title="4">states1<span class="op">$</span>region &lt;-<span class="st"> </span><span class="kw">factor</span>(states1<span class="op">$</span>region, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;South&quot;</span>, <span class="st">&quot;Middle&quot;</span>, <span class="st">&quot;North&quot;</span>))</a>
<a class="sourceLine" id="cb14-5" title="5"><span class="kw">ggplot</span>(<span class="kw">subset</span>(states1, time <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2016</span>,<span class="dv">2066</span>,<span class="dv">2116</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x=</span>ageclass, <span class="dt">weight=</span>area<span class="op">/</span><span class="dv">1000000</span>, <span class="dt">fill=</span>region)) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">end =</span> <span class="fl">0.9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="dt">cols=</span><span class="kw">vars</span>(time)) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="ot">NULL</span>, <span class="dt">title=</span><span class="st">&quot;Area, mill.ha&quot;</span>, <span class="dt">x=</span><span class="st">&quot;Ageclass&quot;</span>, <span class="dt">fill=</span><span class="ot">NULL</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>First the drain in units m3/ha is converted in into eur/ha. Then multiplication with area (ha) gives the euros.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">euro&lt;-<span class="st"> </span><span class="kw">merge</span>(example<span class="op">$</span>drain_coef, example<span class="op">$</span>income_coef) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">euro =</span> euro<span class="op">*</span>drain)</a>
<a class="sourceLine" id="cb15-2" title="2">removal &lt;-<span class="st"> </span><span class="kw">merge</span>(states1, euro) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">income=</span>euro<span class="op">*</span>area)</a>
<a class="sourceLine" id="cb15-3" title="3"></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="kw">ggplot</span>(<span class="kw">subset</span>(removal,<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2116</span>))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x=</span>time, <span class="dt">weight=</span>income<span class="op">/</span><span class="dv">5000000000</span>, <span class="dt">fill=</span>assort)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">end =</span> <span class="fl">0.9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="ot">NULL</span>,<span class="dt">title =</span> <span class="st">&quot;Income, bil.€/year&quot;</span>, <span class="dt">x=</span><span class="st">&quot;5-year intervals&quot;</span>, <span class="dt">fill=</span><span class="ot">NULL</span> )</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-2" class="section level2">
<h2>Example 2</h2>
<p>In this example the tree species changes after final felling. Therefore we redefine final felling activity taking into account in addition to volume and age also the dominant species. The change depends on region and dominant species. Volume and age act as before. They more to the smallest classes (vol1=1 and age1=1).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">ff_age_species &lt;-<span class="st"> </span><span class="kw">define_activity</span>(<span class="st">&quot;ff&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;sp&quot;</span>))</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw">transprobs</span>(ff_age_species) &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">filter</span>(statespace) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="st">                                       </span><span class="kw">select</span>(<span class="dt">vol0=</span>vol, <span class="dt">age0=</span>age, <span class="dt">sp0=</span>sp, region)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="st">  </span><span class="kw">group_by</span>(region, sp0, vol0, age0) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="st">  </span><span class="kw">summarize</span>(<span class="kw">data.frame</span>(<span class="dt">vol1=</span><span class="dv">1</span>, <span class="dt">age1=</span><span class="dv">1</span>, <span class="dt">sp1=</span><span class="kw">c</span>(<span class="st">&#39;other&#39;</span>,<span class="st">&#39;spruce&#39;</span>),</a>
<a class="sourceLine" id="cb16-6" title="6">                       <span class="dt">prob=</span><span class="kw">case_when</span>(sp0<span class="op">==</span><span class="st">&#39;other&#39;</span> <span class="op">&amp;&amp;</span><span class="st"> </span>region<span class="op">==</span><span class="st">&#39;South&#39;</span> <span class="op">~</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb16-7" title="7">                                      sp0<span class="op">==</span><span class="st">&#39;other&#39;</span> <span class="op">&amp;&amp;</span><span class="st"> </span>region<span class="op">==</span><span class="st">&#39;Middle&#39;</span> <span class="op">~</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb16-8" title="8">                                      sp0<span class="op">==</span><span class="st">&#39;other&#39;</span> <span class="op">&amp;&amp;</span><span class="st"> </span>region<span class="op">==</span><span class="st">&#39;North&#39;</span> <span class="op">~</span><span class="st"> </span><span class="kw">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>),</a>
<a class="sourceLine" id="cb16-9" title="9">                                      sp0<span class="op">==</span><span class="st">&#39;spruce&#39;</span> <span class="op">&amp;&amp;</span><span class="st"> </span>region<span class="op">==</span><span class="st">&#39;South&#39;</span> <span class="op">~</span><span class="st"> </span><span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>),</a>
<a class="sourceLine" id="cb16-10" title="10">                                      sp0<span class="op">==</span><span class="st">&#39;spruce&#39;</span> <span class="op">&amp;&amp;</span><span class="st"> </span>region<span class="op">==</span><span class="st">&#39;Middle&#39;</span> <span class="op">~</span><span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>),</a>
<a class="sourceLine" id="cb16-11" title="11">                                      sp0<span class="op">==</span><span class="st">&#39;spruce&#39;</span> <span class="op">&amp;&amp;</span><span class="st"> </span>region<span class="op">==</span><span class="st">&#39;North&#39;</span> <span class="op">~</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))))</a>
<a class="sourceLine" id="cb16-12" title="12"><span class="co">#&gt; `summarise()` has grouped output by &#39;region&#39;, &#39;sp0&#39;, &#39;vol0&#39;, &#39;age0&#39;. You can override using the `.groups` argument.</span></a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">activities2 &lt;-<span class="st"> </span><span class="kw">list</span>(noman, thin, ff_age_species)</a>
<a class="sourceLine" id="cb17-2" title="2">states2 &lt;-<span class="st"> </span><span class="kw">runEFDM</span>(state0, actprob, activities2, <span class="dv">20</span>)</a></code></pre></div>
</div>
<div id="example-3---land-use-changes" class="section level2">
<h2>Example 3 - Land use changes</h2>
<p>First we add two land use classes to the statespace. Agriculture is classified according to region and soil type, while other land use is only classified accoring to region.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">statespace3 &lt;-<span class="st"> </span>statespace</a>
<a class="sourceLine" id="cb18-2" title="2">statespace3<span class="op">$</span>landuse &lt;-<span class="st"> &quot;forest&quot;</span></a>
<a class="sourceLine" id="cb18-3" title="3">agri &lt;-<span class="st"> </span><span class="kw">unique</span>(statespace3 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">sp=</span><span class="dv">0</span>, <span class="dt">vol=</span><span class="dv">0</span>, <span class="dt">age=</span><span class="dv">0</span>, <span class="dt">landuse=</span><span class="st">&quot;agri&quot;</span>))</a>
<a class="sourceLine" id="cb18-4" title="4">other &lt;-<span class="st"> </span><span class="kw">unique</span>(statespace3 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">soil=</span><span class="dv">0</span>, <span class="dt">sp=</span><span class="dv">0</span>, <span class="dt">vol=</span><span class="dv">0</span>, <span class="dt">age=</span><span class="dv">0</span>, <span class="dt">landuse=</span><span class="st">&quot;other&quot;</span>))</a>
<a class="sourceLine" id="cb18-5" title="5">statespace3 &lt;-<span class="st"> </span><span class="kw">rbind</span>(statespace3, agri, other)</a></code></pre></div>
<p>We use separate activities for deforestration to each land use class. Variables not used by the agriculture are set to 0. Soil type and region are not changing as a result of deforestation to agriculture.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">defor_to_agri &lt;-<span class="st"> </span><span class="kw">define_activity</span>(<span class="st">&quot;defor_to_agri&quot;</span>, </a>
<a class="sourceLine" id="cb19-2" title="2">                                          <span class="kw">c</span>(<span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;sp&quot;</span>, <span class="st">&quot;landuse&quot;</span>))</a>
<a class="sourceLine" id="cb19-3" title="3"><span class="kw">transprobs</span>(defor_to_agri) &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">filter</span>(statespace3, landuse<span class="op">==</span><span class="st">&quot;forest&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="st">                                               </span><span class="kw">select</span>(<span class="dt">vol0=</span>vol, <span class="dt">age0=</span>age, <span class="dt">sp0=</span>sp,<span class="dt">landuse0=</span>landuse) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="st">                                               </span><span class="kw">mutate</span>(<span class="dt">vol1=</span><span class="dv">0</span>, <span class="dt">age1=</span><span class="dv">0</span>, <span class="dt">sp1=</span><span class="dv">0</span>, <span class="dt">landuse1=</span><span class="st">&quot;agri&quot;</span>, <span class="dt">prob=</span><span class="dv">1</span>))</a></code></pre></div>
<p>Deforestation to other land use also changes soil type to 0.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">defor_to_other &lt;-<span class="st"> </span><span class="kw">define_activity</span>(<span class="st">&quot;defor_to_other&quot;</span>, </a>
<a class="sourceLine" id="cb20-2" title="2">                                        <span class="kw">c</span>(<span class="st">&quot;soil&quot;</span>, <span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;sp&quot;</span>, <span class="st">&quot;landuse&quot;</span>))</a>
<a class="sourceLine" id="cb20-3" title="3"><span class="kw">transprobs</span>(defor_to_other) &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">filter</span>(statespace3, landuse<span class="op">==</span><span class="st">&quot;forest&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="st">                                             </span><span class="kw">select</span>(<span class="dt">soil0=</span>soil, <span class="dt">vol0=</span>vol, <span class="dt">age0=</span>age, <span class="dt">sp0=</span>sp,<span class="dt">landuse0=</span>landuse) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-5" title="5"><span class="st">                                             </span><span class="kw">mutate</span>(<span class="dt">soil1=</span><span class="dv">0</span>, <span class="dt">vol1=</span><span class="dv">0</span>, <span class="dt">age1=</span><span class="dv">0</span>, <span class="dt">sp1=</span><span class="dv">0</span>, <span class="dt">landuse1=</span><span class="st">&quot;other&quot;</span>, <span class="dt">prob=</span><span class="dv">1</span>))</a></code></pre></div>
<p>Afforestetaion only applies to agriculture. Volume and age classes start from 1 and the area is split evenly to spruce and other species.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">affor &lt;-<span class="st"> </span><span class="kw">define_activity</span>(<span class="st">&quot;affor&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;sp&quot;</span>, <span class="st">&quot;landuse&quot;</span>))</a>
<a class="sourceLine" id="cb21-2" title="2">aff &lt;-<span class="st"> </span><span class="kw">filter</span>(statespace3, landuse<span class="op">==</span><span class="st">&quot;agri&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="st">  </span><span class="kw">select</span>(soil, <span class="dt">vol0=</span>vol, <span class="dt">age0=</span>age, region, <span class="dt">sp0=</span>sp, <span class="dt">landuse0=</span>landuse) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">vol1=</span><span class="dv">1</span>, <span class="dt">age1=</span><span class="dv">1</span>, <span class="dt">sp1=</span><span class="st">&quot;other&quot;</span>, <span class="dt">landuse1=</span><span class="st">&quot;forest&quot;</span>, <span class="dt">prob=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-5" title="5">aff &lt;-<span class="st"> </span><span class="kw">rbind</span>(aff <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">sp1=</span><span class="st">&quot;spruce&quot;</span>, <span class="dt">prob=</span><span class="fl">0.5</span>), </a>
<a class="sourceLine" id="cb21-6" title="6">             aff <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">sp1=</span><span class="st">&quot;other&quot;</span>, <span class="dt">prob=</span><span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb21-7" title="7"><span class="kw">transprobs</span>(affor) &lt;-<span class="st"> </span>aff</a></code></pre></div>
<p>A donothing activity is used for non-forest land uses, when there is nothing forestry related going on.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">donothing &lt;-<span class="st"> </span><span class="kw">define_activity</span>(<span class="st">&quot;donothing&quot;</span>, <span class="kw">character</span>())</a>
<a class="sourceLine" id="cb22-2" title="2">activities3 &lt;-<span class="st"> </span><span class="kw">list</span>(noman, thin, ff, defor_to_other, defor_to_agri, affor, donothing)</a></code></pre></div>
<p>adding land use information to state</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">state03 &lt;-<span class="st"> </span>state0</a>
<a class="sourceLine" id="cb23-2" title="2">state03<span class="op">$</span>landuse &lt;-<span class="st"> &quot;forest&quot;</span></a>
<a class="sourceLine" id="cb23-3" title="3">state03 &lt;-<span class="st"> </span><span class="kw">rbind</span>(state03,  agri <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">area=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1552000</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">997000</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">76000</span><span class="op">/</span><span class="dv">2</span>),<span class="dt">each=</span><span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb23-4" title="4">                 other <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">area=</span><span class="kw">c</span>(<span class="dv">721000</span>,<span class="dv">507000</span>,<span class="dv">112000</span>)))</a></code></pre></div>
<p>Activity probabilities for new land uses</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">actprob3 &lt;-<span class="st"> </span>actprob</a>
<a class="sourceLine" id="cb24-2" title="2">actprob3<span class="op">$</span>defor_to_other &lt;-<span class="st"> </span><span class="fl">0.0002</span></a>
<a class="sourceLine" id="cb24-3" title="3">actprob3<span class="op">$</span>defor_to_agri &lt;-<span class="st"> </span><span class="fl">0.00025</span></a>
<a class="sourceLine" id="cb24-4" title="4">actprob3<span class="op">$</span>affor &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb24-5" title="5">actprob3<span class="op">$</span>landuse &lt;-<span class="st"> &quot;forest&quot;</span></a>
<a class="sourceLine" id="cb24-6" title="6">actprob3<span class="op">$</span>donothing &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb24-7" title="7">actnames &lt;-<span class="st"> </span><span class="kw">setdiff</span>(<span class="kw">names</span>(actprob3), <span class="kw">names</span>(state03))</a>
<a class="sourceLine" id="cb24-8" title="8">actprob3[actnames] &lt;-<span class="st"> </span>actprob3[actnames]<span class="op">/</span><span class="kw">rowSums</span>(actprob3[actnames])</a>
<a class="sourceLine" id="cb24-9" title="9">actprob3 &lt;-<span class="st"> </span><span class="kw">rbind</span>(actprob3, </a>
<a class="sourceLine" id="cb24-10" title="10">        agri <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">thin=</span><span class="dv">0</span>, <span class="dt">ff=</span><span class="dv">0</span>, <span class="dt">noman=</span><span class="dv">0</span>, <span class="dt">defor_to_other=</span><span class="dv">0</span>, <span class="dt">defor_to_agri=</span><span class="dv">0</span>, <span class="dt">affor=</span><span class="fl">0.0005</span>, <span class="dt">donothing=</span><span class="fl">0.9995</span>),</a>
<a class="sourceLine" id="cb24-11" title="11">        other <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">thin=</span><span class="dv">0</span>, <span class="dt">ff=</span><span class="dv">0</span>, <span class="dt">noman=</span><span class="dv">0</span>, <span class="dt">defor_to_other=</span><span class="dv">0</span>, <span class="dt">defor_to_agri=</span><span class="dv">0</span>, <span class="dt">affor=</span><span class="dv">0</span>, <span class="dt">donothing=</span><span class="dv">1</span>))</a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">states3 &lt;-<span class="st"> </span><span class="kw">runEFDM</span>(state03, actprob3, activities3, <span class="dv">20</span>)</a></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
